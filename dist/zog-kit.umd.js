!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ZogKit={})}(this,function(t){"use strict";var e=Object.defineProperty,o=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,a=(t,o,s)=>o in t?e(t,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[o]=s,c=(t,e)=>{for(var o in e||(e={}))n.call(e,o)&&a(t,o,e[o]);if(r)for(var o of r(e))i.call(e,o)&&a(t,o,e[o]);return t},u=(t,e)=>o(t,s(e));const l={name:"ZogKit",version:"0.3.0",install(t,e={}){const{reactive:o,ref:s,computed:r,watchEffect:n,addHook:i,utils:a}=t,{compile:l,Scope:d,evalExp:f}=a,h={http:{baseURL:e.baseURL||"",timeout:e.timeout||3e4,headers:e.headers||{}},storage:{prefix:e.storagePrefix||"zog_",ttl:e.storageTTL||null}};if(i("beforeCompile",t=>{if(1===t.nodeType&&t.hasAttribute("z-pre"))return t.removeAttribute("z-pre"),!1}),i("beforeCompile",(t,e,o)=>{if(1!==t.nodeType||!t.hasAttribute("z-once"))return;t.removeAttribute("z-once");const s=t=>{if(!t)return;if(3===t.nodeType){const o=t.textContent;return void(o.includes("{{")&&(t.textContent=o.replace(/{{\s*(.*?)\s*}}/g,(t,o)=>{var s;try{return null!=(s=f(o,e))?s:""}catch(r){return""}})))}if(1!==t.nodeType)return;const o=[];for(const s of[...t.attributes]){const{name:n,value:i}=s;if(n.startsWith("@")||n.startsWith("z-on:"))o.push(n);else if(n.startsWith(":")||n.startsWith("z-")){o.push(n);try{const o=":"===n[0]?n.slice(1):n,s=f(i,e);if("z-text"===o)t.textContent=null!=s?s:"";else if("z-html"===o)t.innerHTML=null!=s?s:"";else if("z-show"===o)t.style.display=s?"":"none";else if("class"===o)if("object"==typeof s&&null!==s){const e=Object.keys(s).filter(t=>s[t]).join(" ");t.className=(t.className+" "+e).trim()}else"string"==typeof s&&(t.className=(t.className+" "+s).trim());else o.startsWith("z-")||("boolean"==typeof s?s?t.setAttribute(o,""):t.removeAttribute(o):null!=s&&t.setAttribute(o,String(s)))}catch(r){}}}o.forEach(e=>t.removeAttribute(e)),[...t.childNodes].forEach(s)};return s(t),!1}),!document.getElementById("zog-kit-styles")){const t=document.createElement("style");t.id="zog-kit-styles",t.textContent="[z-cloak] { display: none !important; }",document.head.appendChild(t)}i("afterCompile",t=>{1===t.nodeType&&t.hasAttribute("z-cloak")&&t.removeAttribute("z-cloak")}),i("beforeCompile",(t,e,o)=>{if(1!==t.nodeType||!t.hasAttribute("z-autofocus"))return;t.removeAttribute("z-autofocus");const s="af-"+Math.random().toString(36).substr(2,6);t.setAttribute("data-autofocus",s);const r=()=>{const t=document.querySelector(`[data-autofocus="${s}"]`);return!(!t||!document.body.contains(t))&&(t.focus(),!0)};requestAnimationFrame(()=>{if(r())return;const t=new MutationObserver(()=>{r()&&t.disconnect()});t.observe(document.body,{childList:!0,subtree:!0}),o.addEffect(()=>t.disconnect())})}),i("beforeCompile",(t,e,o)=>{if(1!==t.nodeType||!t.hasAttribute("z-click-outside"))return;const s=t.getAttribute("z-click-outside");t.removeAttribute("z-click-outside");const r="zog-outside-"+Math.random().toString(36).substr(2,9);t.setAttribute("data-click-outside-id",r);let i=null;o.addEffect(n(()=>{const o=document.body.contains(t);if(i&&(document.removeEventListener("click",i,!0),i=null),o){const t=t=>{const o=document.querySelector(`[data-click-outside-id="${r}"]`);if(!o||o.contains(t.target))return;const n=e[s];if("function"==typeof n)n(t);else try{Function(...Object.keys(e),"e","$event",`"use strict";${s}`)(...Object.values(e),t,t)}catch(i){}};setTimeout(()=>{document.addEventListener("click",t,!0),i=t},0)}})),o.addEffect(()=>{i&&document.removeEventListener("click",i,!0),t.removeAttribute("data-click-outside-id")})});const p=new class{constructor(t={}){this.config=c(c({},h.http),t),this.pendingRequests=new Map}async request(t,e={}){const o=t.startsWith("http")?t:this.config.baseURL+t,s=new AbortController,r=c({method:e.method||"GET",headers:c(c({"Content-Type":"application/json"},this.config.headers),e.headers),signal:s.signal},e),n=setTimeout(()=>s.abort(),e.timeout||this.config.timeout);!e.body||e.body instanceof FormData||(r.body=JSON.stringify(e.body));try{const t=await fetch(o,r);if(clearTimeout(n),!t.ok)throw new Error(`HTTP Error: ${t.status}`);const e=t.headers.get("content-type");return{data:(null==e?void 0:e.includes("application/json"))?await t.json():await t.text(),response:t,status:t.status}}catch(i){throw clearTimeout(n),i}}get(t,e={}){return this.request(t,u(c({},e),{method:"GET"}))}post(t,e,o={}){return this.request(t,u(c({},o),{method:"POST",body:e}))}put(t,e,o={}){return this.request(t,u(c({},o),{method:"PUT",body:e}))}delete(t,e={}){return this.request(t,u(c({},e),{method:"DELETE"}))}};class m{constructor(t,e="zog_"){this.storage=t,this.prefix=e}_getKey(t){return this.prefix+t}set(t,e,o=null){try{return this.storage.setItem(this._getKey(t),JSON.stringify({value:e,timestamp:Date.now(),ttl:o})),!0}catch(s){return!1}}get(t,e=null){try{const o=this.storage.getItem(this._getKey(t));if(!o)return e;const s=JSON.parse(o);return s.ttl&&Date.now()-s.timestamp>s.ttl?(this.remove(t),e):s.value}catch(o){return e}}remove(t){this.storage.removeItem(this._getKey(t))}clear(){Object.keys(this.storage).forEach(t=>{t.startsWith(this.prefix)&&this.storage.removeItem(t)})}has(t){return null!==this.storage.getItem(this._getKey(t))}reactive(t,e=null,o=null){const r=this.get(t,e),i=s(r);return n(()=>{this.set(t,i.value,o)}),i}}const b=new m(localStorage,h.storage.prefix),y=new m(sessionStorage,h.storage.prefix);function g(t,e=300){let o;return function(...s){clearTimeout(o),o=setTimeout(()=>t.apply(this,s),e)}}function v(t,e=300){let o;return function(...s){o||(t.apply(this,s),o=!0,setTimeout(()=>o=!1,e))}}i("beforeCompile",(t,e,o)=>{if(1!==t.nodeType)return;const s=[],r=[];[...t.attributes].forEach(t=>{if(t.name.startsWith("@")||t.name.startsWith("z-on:")){const e=t.name.split(".");if(e.length>1){const o=e.slice(1),n=o.includes("debounce"),i=o.includes("throttle");if(n||i){const i=parseInt(o.find(t=>!isNaN(t)))||300,a="@"===t.name[0]?e[0].slice(1):e[0].slice(5),c=t.value;s.push(t.name),r.push({eventName:a,expression:c,wrapper:n?g:v,delay:i})}}}}),s.forEach(e=>t.removeAttribute(e)),r.forEach(({eventName:s,expression:r,wrapper:n,delay:i})=>{const a=n(t=>{const o=e[r];if("function"==typeof o)o(t);else try{Function(...Object.keys(e),"e",`"use strict";${r}`)(...Object.values(e),t)}catch(s){}},i);t.addEventListener(s,a),o.addListener(t,s,a)})});const z=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const e=t.target,o=e.getAttribute("data-lazy-src");o&&(e.src=o,e.removeAttribute("data-lazy-src"),z.unobserve(e))}})},{rootMargin:"50px"});i("afterCompile",t=>{if(1===t.nodeType&&t.hasAttribute("z-lazy")){const e=t.getAttribute("z-lazy");t.removeAttribute("z-lazy"),t.setAttribute("data-lazy-src",e),z.observe(t)}});const T={async copy(t){try{return await navigator.clipboard.writeText(t),!0}catch(e){const o=document.createElement("textarea");o.value=t,o.style.cssText="position:fixed;opacity:0",document.body.appendChild(o),o.select();const s=document.execCommand("copy");return document.body.removeChild(o),s}}};i("beforeCompile",(t,e,o)=>{if(1!==t.nodeType||!t.hasAttribute("z-copy"))return;const s=t.getAttribute("z-copy");t.removeAttribute("z-copy");const r=async()=>{try{const o=f(s,e);await T.copy(String(o))&&t.dispatchEvent(new CustomEvent("copied",{detail:o,bubbles:!0}))}catch(o){}};t.addEventListener("click",r),o.addListener(t,"click",r)});const E=new class{constructor(){this.events=new Map}on(t,e){return this.events.has(t)||this.events.set(t,new Set),this.events.get(t).add(e),()=>this.off(t,e)}off(t,e){var o;null==(o=this.events.get(t))||o.delete(e)}emit(t,e){var o;null==(o=this.events.get(t))||o.forEach(t=>t(e))}once(t,e){const o=s=>{e(s),this.off(t,o)};this.on(t,o)}clear(t){t?this.events.delete(t):this.events.clear()}};return{$http:p,$storage:b,$session:y,$clipboard:T,$bus:E,utils:{debounce:g,throttle:v},version:this.version}}};t.ZogKit=l,t.default=l,Object.defineProperties(t,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=zog-kit.umd.js.map
