{"version":3,"file":"zog-kit.es.js","sources":["../src/zog-kit.js"],"sourcesContent":["/**\n * ZogKit v0.3.0\n * Essential utilities plugin for Zog.js\n * \n * @description A comprehensive utilities plugin providing HTTP client, storage helpers,\n * DOM directives, event bus, and performance utilities for Zog.js applications\n * @author Ben Khalife\n * @license MIT\n */\n\nexport const ZogKit = {\n    name: 'ZogKit',\n    version: '0.3.0',\n\n    install(zog, options = {}) {\n        const { reactive, ref, computed, watchEffect, addHook, utils } = zog;\n        const { compile, Scope, evalExp } = utils;\n\n        // Configuration\n        const config = {\n            http: {\n                baseURL: options.baseURL || '',\n                timeout: options.timeout || 30000,\n                headers: options.headers || {}\n            },\n            storage: {\n                prefix: options.storagePrefix || 'zog_',\n                ttl: options.storageTTL || null\n            }\n        };\n\n        // ============================================\n        // z-pre: Skip compilation completely\n        // ============================================\n        addHook('beforeCompile', (el) => {\n            if (el.nodeType === 1 && el.hasAttribute('z-pre')) {\n                el.removeAttribute('z-pre');\n                return false;\n            }\n        });\n\n        // ============================================\n        // z-once: Render once without reactivity\n        // ============================================\n        addHook('beforeCompile', (el, scope, cs) => {\n            if (el.nodeType !== 1 || !el.hasAttribute('z-once')) return;\n\n            el.removeAttribute('z-once');\n\n            const compileOnce = (node) => {\n                if (!node) return;\n\n                // Process text nodes with interpolation\n                if (node.nodeType === 3) {\n                    const txt = node.textContent;\n                    if (txt.includes('{{')) {\n                        node.textContent = txt.replace(/{{\\s*(.*?)\\s*}}/g, (_, exp) => {\n                            try {\n                                return evalExp(exp, scope) ?? '';\n                            } catch (err) {\n                                return '';\n                            }\n                        });\n                    }\n                    return;\n                }\n\n                if (node.nodeType !== 1) return;\n\n                const attrsToRemove = [];\n\n                // Process reactive attributes\n                for (const attr of [...node.attributes]) {\n                    const { name, value } = attr;\n\n                    // Skip event handlers\n                    if (name.startsWith('@') || name.startsWith('z-on:')) {\n                        attrsToRemove.push(name);\n                        continue;\n                    }\n\n                    // Process directives and bindings\n                    if (name.startsWith(':') || name.startsWith('z-')) {\n                        attrsToRemove.push(name);\n\n                        try {\n                            const attrName = name[0] === ':' ? name.slice(1) : name;\n                            const result = evalExp(value, scope);\n\n                            if (attrName === 'z-text') {\n                                node.textContent = result ?? '';\n                            } else if (attrName === 'z-html') {\n                                node.innerHTML = result ?? '';\n                            } else if (attrName === 'z-show') {\n                                node.style.display = result ? '' : 'none';\n                            } else if (attrName === 'class') {\n                                if (typeof result === 'object' && result !== null) {\n                                    const dynamic = Object.keys(result).filter(k => result[k]).join(' ');\n                                    node.className = (node.className + ' ' + dynamic).trim();\n                                } else if (typeof result === 'string') {\n                                    node.className = (node.className + ' ' + result).trim();\n                                }\n                            } else if (!attrName.startsWith('z-')) {\n                                if (typeof result === 'boolean') {\n                                    result ? node.setAttribute(attrName, '') : node.removeAttribute(attrName);\n                                } else if (result != null) {\n                                    node.setAttribute(attrName, String(result));\n                                }\n                            }\n                        } catch (err) {\n                            // Silent fail for production\n                        }\n                    }\n                }\n\n                attrsToRemove.forEach(name => node.removeAttribute(name));\n                [...node.childNodes].forEach(compileOnce);\n            };\n\n            compileOnce(el);\n            return false;\n        });\n\n        // ============================================\n        // z-cloak: Hide element until compiled\n        // ============================================\n        if (!document.getElementById('zog-kit-styles')) {\n            const style = document.createElement('style');\n            style.id = 'zog-kit-styles';\n            style.textContent = `[z-cloak] { display: none !important; }`;\n            document.head.appendChild(style);\n        }\n\n        addHook('afterCompile', (el) => {\n            if (el.nodeType === 1 && el.hasAttribute('z-cloak')) {\n                el.removeAttribute('z-cloak');\n            }\n        });\n\n        // ============================================\n        // z-autofocus: Auto focus when element appears\n        // ============================================\n        addHook('beforeCompile', (el, scope, cs) => {\n            if (el.nodeType !== 1 || !el.hasAttribute('z-autofocus')) return;\n\n            el.removeAttribute('z-autofocus');\n\n            const markerId = 'af-' + Math.random().toString(36).substr(2, 6);\n            el.setAttribute('data-autofocus', markerId);\n\n            const tryFocus = () => {\n                const realEl = document.querySelector(`[data-autofocus=\"${markerId}\"]`);\n                if (realEl && document.body.contains(realEl)) {\n                    realEl.focus();\n                    return true;\n                }\n                return false;\n            };\n\n            // Attempt to focus after DOM updates\n            requestAnimationFrame(() => {\n                if (tryFocus()) return;\n\n                // Wait for element to be inserted (e.g., via z-if)\n                const observer = new MutationObserver(() => {\n                    if (tryFocus()) {\n                        observer.disconnect();\n                    }\n                });\n\n                observer.observe(document.body, { childList: true, subtree: true });\n                cs.addEffect(() => observer.disconnect());\n            });\n        });\n\n        // ============================================\n        // z-click-outside: Detect clicks outside element\n        // ============================================\n        addHook('beforeCompile', (el, scope, cs) => {\n            if (el.nodeType !== 1 || !el.hasAttribute('z-click-outside')) return;\n\n            const expression = el.getAttribute('z-click-outside');\n            el.removeAttribute('z-click-outside');\n\n            const uniqueId = 'zog-outside-' + Math.random().toString(36).substr(2, 9);\n            el.setAttribute('data-click-outside-id', uniqueId);\n\n            let currentListener = null;\n\n            cs.addEffect(watchEffect(() => {\n                const inDOM = document.body.contains(el);\n\n                if (currentListener) {\n                    document.removeEventListener('click', currentListener, true);\n                    currentListener = null;\n                }\n\n                if (inDOM) {\n                    const handleClickOutside = (e) => {\n                        const realEl = document.querySelector(`[data-click-outside-id=\"${uniqueId}\"]`);\n\n                        if (!realEl || realEl.contains(e.target)) return;\n\n                        const fn = scope[expression];\n                        if (typeof fn === 'function') {\n                            fn(e);\n                        } else {\n                            try {\n                                Function(...Object.keys(scope), 'e', '$event', `\"use strict\";${expression}`)(\n                                    ...Object.values(scope), e, e\n                                );\n                            } catch (err) {\n                                // Silent fail for production\n                            }\n                        }\n                    };\n\n                    setTimeout(() => {\n                        document.addEventListener('click', handleClickOutside, true);\n                        currentListener = handleClickOutside;\n                    }, 0);\n                }\n            }));\n\n            cs.addEffect(() => {\n                if (currentListener) {\n                    document.removeEventListener('click', currentListener, true);\n                }\n                el.removeAttribute('data-click-outside-id');\n            });\n        });\n\n        // ============================================\n        // HTTP Client\n        // ============================================\n        class ZogFetch {\n            constructor(baseConfig = {}) {\n                this.config = { ...config.http, ...baseConfig };\n                this.pendingRequests = new Map();\n            }\n\n            async request(url, options = {}) {\n                const fullURL = url.startsWith('http') ? url : this.config.baseURL + url;\n                const controller = new AbortController();\n\n                const finalOptions = {\n                    method: options.method || 'GET',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        ...this.config.headers,\n                        ...options.headers\n                    },\n                    signal: controller.signal,\n                    ...options\n                };\n\n                const timeoutId = setTimeout(() => controller.abort(), options.timeout || this.config.timeout);\n\n                if (options.body && !(options.body instanceof FormData)) {\n                    finalOptions.body = JSON.stringify(options.body);\n                }\n\n                try {\n                    const response = await fetch(fullURL, finalOptions);\n                    clearTimeout(timeoutId);\n\n                    if (!response.ok) {\n                        throw new Error(`HTTP Error: ${response.status}`);\n                    }\n\n                    const contentType = response.headers.get('content-type');\n                    const data = contentType?.includes('application/json')\n                        ? await response.json()\n                        : await response.text();\n\n                    return { data, response, status: response.status };\n                } catch (error) {\n                    clearTimeout(timeoutId);\n                    throw error;\n                }\n            }\n\n            get(url, options = {}) { return this.request(url, { ...options, method: 'GET' }); }\n            post(url, body, options = {}) { return this.request(url, { ...options, method: 'POST', body }); }\n            put(url, body, options = {}) { return this.request(url, { ...options, method: 'PUT', body }); }\n            delete(url, options = {}) { return this.request(url, { ...options, method: 'DELETE' }); }\n        }\n\n        const $http = new ZogFetch();\n\n        // ============================================\n        // Storage Helper\n        // ============================================\n        class StorageHelper {\n            constructor(storage, prefix = 'zog_') {\n                this.storage = storage;\n                this.prefix = prefix;\n            }\n\n            _getKey(key) { return this.prefix + key; }\n\n            set(key, value, ttl = null) {\n                try {\n                    this.storage.setItem(this._getKey(key), JSON.stringify({ value, timestamp: Date.now(), ttl }));\n                    return true;\n                } catch (e) { return false; }\n            }\n\n            get(key, defaultValue = null) {\n                try {\n                    const item = this.storage.getItem(this._getKey(key));\n                    if (!item) return defaultValue;\n                    const data = JSON.parse(item);\n                    if (data.ttl && (Date.now() - data.timestamp) > data.ttl) {\n                        this.remove(key);\n                        return defaultValue;\n                    }\n                    return data.value;\n                } catch (e) { return defaultValue; }\n            }\n\n            remove(key) { this.storage.removeItem(this._getKey(key)); }\n\n            clear() {\n                Object.keys(this.storage).forEach(key => {\n                    if (key.startsWith(this.prefix)) this.storage.removeItem(key);\n                });\n            }\n\n            has(key) { return this.storage.getItem(this._getKey(key)) !== null; }\n\n            reactive(key, defaultValue = null, ttl = null) {\n                const storedValue = this.get(key, defaultValue);\n                const state = ref(storedValue);\n                watchEffect(() => { this.set(key, state.value, ttl); });\n                return state;\n            }\n        }\n\n        const $storage = new StorageHelper(localStorage, config.storage.prefix);\n        const $session = new StorageHelper(sessionStorage, config.storage.prefix);\n\n        // ============================================\n        // Performance Utilities\n        // ============================================\n        function debounce(fn, delay = 300) {\n            let timeoutId;\n            return function (...args) {\n                clearTimeout(timeoutId);\n                timeoutId = setTimeout(() => fn.apply(this, args), delay);\n            };\n        }\n\n        function throttle(fn, limit = 300) {\n            let inThrottle;\n            return function (...args) {\n                if (!inThrottle) {\n                    fn.apply(this, args);\n                    inThrottle = true;\n                    setTimeout(() => inThrottle = false, limit);\n                }\n            };\n        }\n\n        // ============================================\n        // Event Modifier Processing (debounce/throttle)\n        // ============================================\n        addHook('beforeCompile', (el, scope, cs) => {\n            if (el.nodeType !== 1) return;\n\n            const attrsToRemove = [];\n            const eventsToAdd = [];\n\n            [...el.attributes].forEach(attr => {\n                if (attr.name.startsWith('@') || attr.name.startsWith('z-on:')) {\n                    const parts = attr.name.split('.');\n                    if (parts.length > 1) {\n                        const modifiers = parts.slice(1);\n                        const hasDebounce = modifiers.includes('debounce');\n                        const hasThrottle = modifiers.includes('throttle');\n\n                        if (hasDebounce || hasThrottle) {\n                            const delay = parseInt(modifiers.find(m => !isNaN(m))) || 300;\n                            const eventName = attr.name[0] === '@' ? parts[0].slice(1) : parts[0].slice(5);\n                            const expression = attr.value;\n\n                            attrsToRemove.push(attr.name);\n                            eventsToAdd.push({ eventName, expression, wrapper: hasDebounce ? debounce : throttle, delay });\n                        }\n                    }\n                }\n            });\n\n            attrsToRemove.forEach(name => el.removeAttribute(name));\n\n            eventsToAdd.forEach(({ eventName, expression, wrapper, delay }) => {\n                const handler = (e) => {\n                    const fn = scope[expression];\n                    if (typeof fn === 'function') {\n                        fn(e);\n                    } else {\n                        try {\n                            Function(...Object.keys(scope), 'e', `\"use strict\";${expression}`)(...Object.values(scope), e);\n                        } catch (err) {\n                            // Silent fail for production\n                        }\n                    }\n                };\n\n                const wrappedHandler = wrapper(handler, delay);\n                el.addEventListener(eventName, wrappedHandler);\n                cs.addListener(el, eventName, wrappedHandler);\n            });\n        });\n\n        // ============================================\n        // Lazy Loading\n        // ============================================\n        const lazyObserver = new IntersectionObserver((entries) => {\n            entries.forEach(entry => {\n                if (entry.isIntersecting) {\n                    const img = entry.target;\n                    const src = img.getAttribute('data-lazy-src');\n                    if (src) {\n                        img.src = src;\n                        img.removeAttribute('data-lazy-src');\n                        lazyObserver.unobserve(img);\n                    }\n                }\n            });\n        }, { rootMargin: '50px' });\n\n        addHook('afterCompile', (el) => {\n            if (el.nodeType === 1 && el.hasAttribute('z-lazy')) {\n                const src = el.getAttribute('z-lazy');\n                el.removeAttribute('z-lazy');\n                el.setAttribute('data-lazy-src', src);\n                lazyObserver.observe(el);\n            }\n        });\n\n        // ============================================\n        // Clipboard Helper\n        // ============================================\n        const $clipboard = {\n            async copy(text) {\n                try {\n                    await navigator.clipboard.writeText(text);\n                    return true;\n                } catch (err) {\n                    // Fallback for older browsers\n                    const textarea = document.createElement('textarea');\n                    textarea.value = text;\n                    textarea.style.cssText = 'position:fixed;opacity:0';\n                    document.body.appendChild(textarea);\n                    textarea.select();\n                    const success = document.execCommand('copy');\n                    document.body.removeChild(textarea);\n                    return success;\n                }\n            }\n        };\n\n        addHook('beforeCompile', (el, scope, cs) => {\n            if (el.nodeType !== 1 || !el.hasAttribute('z-copy')) return;\n\n            const expression = el.getAttribute('z-copy');\n            el.removeAttribute('z-copy');\n\n            const clickHandler = async () => {\n                try {\n                    const text = evalExp(expression, scope);\n                    const success = await $clipboard.copy(String(text));\n                    if (success) {\n                        el.dispatchEvent(new CustomEvent('copied', { detail: text, bubbles: true }));\n                    }\n                } catch (err) {\n                    // Silent fail for production\n                }\n            };\n\n            el.addEventListener('click', clickHandler);\n            cs.addListener(el, 'click', clickHandler);\n        });\n\n        // ============================================\n        // Event Bus\n        // ============================================\n        class EventBus {\n            constructor() { this.events = new Map(); }\n\n            on(event, handler) {\n                if (!this.events.has(event)) this.events.set(event, new Set());\n                this.events.get(event).add(handler);\n                return () => this.off(event, handler);\n            }\n\n            off(event, handler) { this.events.get(event)?.delete(handler); }\n\n            emit(event, data) { this.events.get(event)?.forEach(h => h(data)); }\n\n            once(event, handler) {\n                const once = (data) => { handler(data); this.off(event, once); };\n                this.on(event, once);\n            }\n\n            clear(event) { event ? this.events.delete(event) : this.events.clear(); }\n        }\n\n        const $bus = new EventBus();\n\n        // Return public API\n        return {\n            $http,\n            $storage,\n            $session,\n            $clipboard,\n            $bus,\n            utils: { debounce, throttle },\n            version: this.version\n        };\n    }\n};\n\nexport default ZogKit;"],"names":["ZogKit","name","version","install","zog","options","reactive","ref","computed","watchEffect","addHook","utils","compile","Scope","evalExp","config","http","baseURL","timeout","headers","storage","prefix","storagePrefix","ttl","storageTTL","el","nodeType","hasAttribute","removeAttribute","scope","cs","compileOnce","node","txt","textContent","includes","replace","_","exp","_a","err","attrsToRemove","attr","attributes","value","startsWith","push","attrName","slice","result","innerHTML","style","display","dynamic","Object","keys","filter","k","join","className","trim","setAttribute","String","forEach","childNodes","document","getElementById","createElement","id","head","appendChild","markerId","Math","random","toString","substr","tryFocus","realEl","querySelector","body","contains","focus","requestAnimationFrame","observer","MutationObserver","disconnect","observe","childList","subtree","addEffect","expression","getAttribute","uniqueId","currentListener","inDOM","removeEventListener","handleClickOutside","e","target","fn","Function","values","setTimeout","addEventListener","$http","constructor","baseConfig","this","__spreadValues","pendingRequests","Map","request","url","fullURL","controller","AbortController","finalOptions","method","signal","timeoutId","abort","FormData","JSON","stringify","response","fetch","clearTimeout","ok","Error","status","contentType","get","data","json","text","error","__spreadProps","post","put","StorageHelper","_getKey","key","set","setItem","timestamp","Date","now","defaultValue","item","getItem","parse","remove","removeItem","clear","has","storedValue","state","$storage","localStorage","$session","sessionStorage","debounce","delay","args","apply","throttle","limit","inThrottle","eventsToAdd","parts","split","length","modifiers","hasDebounce","hasThrottle","parseInt","find","m","isNaN","eventName","wrapper","wrappedHandler","addListener","lazyObserver","IntersectionObserver","entries","entry","isIntersecting","img","src","unobserve","rootMargin","$clipboard","copy","navigator","clipboard","writeText","textarea","cssText","select","success","execCommand","removeChild","clickHandler","async","dispatchEvent","CustomEvent","detail","bubbles","$bus","events","on","event","handler","Set","add","off","delete","emit","h","once"],"mappings":"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"}